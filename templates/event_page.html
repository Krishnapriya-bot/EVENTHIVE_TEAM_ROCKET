<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>{{ event.title }} - EventHive</title>
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='screen3.css') }}"
    />
    <style>
      .event-image img {
        max-width: 100%;
        max-height: 180px;
        object-fit: cover;
        display: block;
        margin: 0 auto;
      }
    </style>
  </head>
  <body>
    <!-- Header -->
    <div class="header">
      <div class="logo">EventHive</div>
      <div class="user-profile">M</div>
    </div>

    <!-- Main Container -->
    <div class="main-container">
      <!-- Breadcrumbs -->

      <!-- Event Content (restores your old flex layout) -->
      <div class="event-content">
        <!-- Main Event Section -->
        <div class="event-main">
          <div class="event-header">
            <div class="event-image">
              {% if event.image_url %}
              <img
                src="{{ event.image_url }}"
                alt="{{ event.title }}"
                class="w-100 rounded"
              />
              {% else %}
              <div
                class="bg-light d-flex justify-content-center align-items-center"
                style="height: 250px"
              >
                <span class="text-muted">No Image Available</span>
              </div>
              {% endif %}

              <div class="event-badge">
                {% if event.get_total_bookings() > 0 %} Registered {% else %}
                Upcoming {% endif %}
              </div>

              <div class="event-title">{{ event.title }}</div>
              <div class="event-tagline">
                {{ event.description[:100] }}{% if event.description|length >
                100 %}...{% endif %}
              </div>
            </div>
          </div>

          <!-- Event Description -->
          <div class="event-description">
            <h3>About This Event</h3>
            <p>{{ event.description }}</p>
          </div>
        </div>

        <!-- Sidebar -->
        <div class="event-sidebar">
          <div class="register-section">
            <a
              href="{{ url_for('join_event', event_id=event.event_id) }}"
              class="btn"
              >Join</a
            >
            <div class="event-date">
              {{ event.start_datetime.strftime('%b %d, %Y') }}
            </div>
            <div class="event-time">
              {{ event.start_datetime.strftime('%I:%M %p') }} - {{
              event.end_datetime.strftime('%I:%M %p') }}
            </div>
            <div class="event-duration">Add to calendar</div>
          </div>

          <!-- Location Section -->
          <div class="location-section">
            <h3><span class="location-icon">üìç</span> Location</h3>
            <div class="location-address">{{ event.location }}</div>
            <div
              id="map"
              style="height: 200px; margin-top: 10px"
              data-lat="{{ lat or 28.6139 }}"
              data-lon="{{ lon or 77.2090 }}"
            ></div>
          </div>

          <!-- Organizer Section -->
          <div class="organizer-section">
            <h3>Organizer</h3>
            <div class="organizer-name">{{ organizer.name }}</div>
            <div class="organizer-contact">
              üìû {{ organizer.phone or "N/A" }}
            </div>
            <div class="organizer-contact">‚úâÔ∏è {{ organizer.email }}</div>
          </div>
        </div>
      </div>
    </div>
    <link
      rel="stylesheet"
      href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script>
      const mapDiv = document.getElementById("map");
      const lat = parseFloat(mapDiv.getAttribute("data-lat"));
      const lon = parseFloat(mapDiv.getAttribute("data-lon"));

      const map = L.map("map").setView([lat, lon], 15);
      L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
        attribution: "¬© OpenStreetMap contributors",
      }).addTo(map);
      L.marker([lat, lon])
        .addTo(map)
        .bindPopup(mapDiv.previousElementSibling.textContent.trim())
        .openPopup();
    </script>
  </body>
</html>
