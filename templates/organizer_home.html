<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Organizer Home</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">
  <style>
    .card { margin-bottom: 20px; }
    .status-badge { font-size: 0.9rem; }
  </style>
</head>
<body class="p-4">
  <h2>Welcome, {{ name }}</h2>

  <!-- Filters -->
  <form method="get" class="row g-2 mb-3">
    <div class="col-md-3">
      <input type="text" name="search" value="{{ search_query }}" class="form-control" placeholder="Search events...">
    </div>
    <div class="col-md-3">
      <select name="category" class="form-select">
        <option value="">All Categories</option>
        {% for cat in ["General","Workshop","Conference","Meetup"] %}
        <option value="{{ cat }}" {% if category_filter==cat %}selected{% endif %}>{{ cat }}</option>
        {% endfor %}
      </select>
    </div>
    <div class="col-md-2">
      <button class="btn btn-primary">Filter</button>
    </div>
    <div class="col-md-4 text-end">
      <a href="{{ url_for('create_event') }}" class="btn btn-success">Create New Event</a>
    </div>
  </form>

  <!-- Event Cards -->
  <div class="row">
    {% for event in events.items %}
    <div class="col-md-4">
      <div class="card">
        <img src="https://via.placeholder.com/350x150" class="card-img-top" alt="Event Image">
        <div class="card-body">
          <h5 class="card-title">{{ event.title }}</h5>
          <p class="card-text">{{ event.category }} | {{ event.start_datetime.strftime('%d %b %Y %H:%M') }}</p>
          <span class="badge bg-{{ 'success' if event.status=='published' else 'secondary' }} status-badge">{{ event.status }}</span>
          <div class="mt-2">
            <a href="{{ url_for('create_event', event_id=event.event_id) }}" class="btn btn-sm btn-primary">Edit</a>
            <a href="{{ url_for('toggle_event_status', event_id=event.event_id) }}" class="btn btn-sm btn-warning">
              {% if event.status=='published' %}Unpublish{% else %}Publish{% endif %}
            </a>
            <a href="{{ url_for('attendees', event_id=event.event_id) }}" class="btn btn-sm btn-info">Attendees</a>
          </div>
        </div>
      </div>
    </div>
    {% endfor %}
  </div>

  <!-- Pagination -->
  <nav>
    <ul class="pagination justify-content-center">
      {% if events.has_prev %}
      <li class="page-item">
        <a class="page-link" href="{{ url_for('organizer_home', page=events.prev_num) }}">Previous</a>
      </li>
      {% endif %}
      {% for page_num in events.iter_pages() %}
      {% if page_num %}
      <li class="page-item {% if page_num==events.page %}active{% endif %}">
        <a class="page-link" href="{{ url_for('organizer_home', page=page_num) }}">{{ page_num }}</a>
      </li>
      {% endif %}
      {% endfor %}
      {% if events.has_next %}
      <li class="page-item">
        <a class="page-link" href="{{ url_for('organizer_home', page=events.next_num) }}">Next</a>
      </li>
      {% endif %}
    </ul>
  </nav>
</body>
</html>
